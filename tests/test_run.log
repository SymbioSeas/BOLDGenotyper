[2025-11-03 14:42:44] INFO: Logging to file: tests/test_run.log
[2025-11-03 14:42:44] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 14:42:45] INFO: Read 381 rows and 89 columns
[2025-11-03 14:42:45] ERROR: Found 4 duplicate processids. Examples: ['GBMTG5888-16', 'GBMTG5888-16', 'GBMTG5888-16', 'GBMTG5888-16']
[2025-11-03 14:46:33] INFO: Logging to file: tests/test_run.log
[2025-11-03 14:46:33] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 14:46:33] INFO: Read 376 rows and 89 columns
[2025-11-03 14:46:33] INFO: Data quality summary:
[2025-11-03 14:46:33] INFO:   total_rows: 376
[2025-11-03 14:46:33] INFO:   total_columns: 89
[2025-11-03 14:46:33] INFO:   unique_processids: 376
[2025-11-03 14:46:33] INFO:   sequences_present: 376
[2025-11-03 14:46:33] INFO:   sequences_missing: 0
[2025-11-03 14:46:33] INFO:   empty_sequences: 0
[2025-11-03 14:46:33] INFO:   coords_present: 149
[2025-11-03 14:46:33] INFO:   coords_missing: 227
[2025-11-03 14:46:33] INFO:   centroid_coords: 36
[2025-11-03 14:46:33] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 14:46:33] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 14:46:34] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 14:47:28] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 14:47:28] INFO: Creating point geometries from coordinates
[2025-11-03 15:44:38] INFO: Logging to file: tests/test_run.log
[2025-11-03 15:44:39] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 15:44:39] INFO: Read 376 rows and 89 columns
[2025-11-03 15:44:39] INFO: Data quality summary:
[2025-11-03 15:44:39] INFO:   total_rows: 376
[2025-11-03 15:44:39] INFO:   total_columns: 89
[2025-11-03 15:44:39] INFO:   unique_processids: 376
[2025-11-03 15:44:39] INFO:   sequences_present: 376
[2025-11-03 15:44:39] INFO:   sequences_missing: 0
[2025-11-03 15:44:39] INFO:   empty_sequences: 0
[2025-11-03 15:44:39] INFO:   coords_present: 149
[2025-11-03 15:44:39] INFO:   coords_missing: 227
[2025-11-03 15:44:39] INFO:   centroid_coords: 36
[2025-11-03 15:44:39] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 15:44:39] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 15:44:39] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 15:45:19] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 15:50:36] INFO: Logging to file: tests/test_run.log
[2025-11-03 15:50:36] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 15:50:36] INFO: Read 376 rows and 89 columns
[2025-11-03 15:50:36] INFO: Data quality summary:
[2025-11-03 15:50:36] INFO:   total_rows: 376
[2025-11-03 15:50:36] INFO:   total_columns: 89
[2025-11-03 15:50:36] INFO:   unique_processids: 376
[2025-11-03 15:50:36] INFO:   sequences_present: 376
[2025-11-03 15:50:36] INFO:   sequences_missing: 0
[2025-11-03 15:50:36] INFO:   empty_sequences: 0
[2025-11-03 15:50:36] INFO:   coords_present: 149
[2025-11-03 15:50:36] INFO:   coords_missing: 227
[2025-11-03 15:50:36] INFO:   centroid_coords: 36
[2025-11-03 15:50:36] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 15:50:36] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 15:50:36] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 15:51:15] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 15:51:34] INFO: Logging to file: tests/test_run.log
[2025-11-03 15:51:34] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 15:51:34] INFO: Read 376 rows and 89 columns
[2025-11-03 15:51:34] INFO: Data quality summary:
[2025-11-03 15:51:34] INFO:   total_rows: 376
[2025-11-03 15:51:34] INFO:   total_columns: 89
[2025-11-03 15:51:34] INFO:   unique_processids: 376
[2025-11-03 15:51:34] INFO:   sequences_present: 376
[2025-11-03 15:51:34] INFO:   sequences_missing: 0
[2025-11-03 15:51:34] INFO:   empty_sequences: 0
[2025-11-03 15:51:34] INFO:   coords_present: 149
[2025-11-03 15:51:34] INFO:   coords_missing: 227
[2025-11-03 15:51:34] INFO:   centroid_coords: 36
[2025-11-03 15:51:34] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 15:51:34] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 15:51:34] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 15:52:07] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 15:52:07] INFO: ======================================================================
[2025-11-03 15:52:07] INFO: Starting sequence dereplication workflow
[2025-11-03 15:52:07] INFO: ======================================================================
[2025-11-03 15:52:07] INFO: Step 1/7: Reading sequences from tests/data/Sphyrnidae_test.tsv
[2025-11-03 15:55:03] INFO: Logging to file: tests/test_run.log
[2025-11-03 15:55:03] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 15:55:03] INFO: Read 376 rows and 89 columns
[2025-11-03 15:55:03] INFO: Data quality summary:
[2025-11-03 15:55:03] INFO:   total_rows: 376
[2025-11-03 15:55:03] INFO:   total_columns: 89
[2025-11-03 15:55:03] INFO:   unique_processids: 376
[2025-11-03 15:55:03] INFO:   sequences_present: 376
[2025-11-03 15:55:03] INFO:   sequences_missing: 0
[2025-11-03 15:55:03] INFO:   empty_sequences: 0
[2025-11-03 15:55:03] INFO:   coords_present: 149
[2025-11-03 15:55:03] INFO:   coords_missing: 227
[2025-11-03 15:55:03] INFO:   centroid_coords: 36
[2025-11-03 15:55:03] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 15:55:03] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 15:55:03] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 15:55:38] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 15:55:38] INFO: ======================================================================
[2025-11-03 15:55:38] INFO: Starting sequence dereplication workflow
[2025-11-03 15:55:38] INFO: ======================================================================
[2025-11-03 15:55:38] INFO: Step 1/7: Reading sequences from tests/data/Sphyrnidae_test.tsv
[2025-11-03 15:55:38] INFO: Found 376 sequences
[2025-11-03 15:55:38] INFO: Step 2/7: Writing unaligned sequences to tests/output/dereplication/Sphyrnidae_test_sequences.fasta
[2025-11-03 15:55:38] INFO: Wrote 376 sequences to FASTA
[2025-11-03 15:55:38] INFO: Step 3/7: Running MAFFT alignment
[2025-11-03 15:55:38] INFO: Running MAFFT alignment: mafft --auto tests/output/dereplication/Sphyrnidae_test_sequences.fasta
[2025-11-03 15:55:41] ERROR: MAFFT alignment failed:
nthread = 0
nthreadpair = 0
nthreadtb = 0
ppenalty_ex = 0
stacksize: 8176 kb
generating a scoring matrix for nucleotide (dist=200) ... done
Gap Penalty = -1.53, +0.00, +0.00
========================================================================= 
========================================================================= 
=== 
=== Alphabet 'e' is unknown.
=== Please check site 4 in sequence 262.
=== 
=== To make an alignment that has unusual characters (U, @, #, etc), try  
=== % mafft --anysymbol input > output
=== 
========================================================================= 
========================================================================= 
Illegal character e

[2025-11-03 16:22:53] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:22:53] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 16:22:53] INFO: Read 376 rows and 89 columns
[2025-11-03 16:22:53] INFO: Data quality summary:
[2025-11-03 16:22:53] INFO:   total_rows: 376
[2025-11-03 16:22:53] INFO:   total_columns: 89
[2025-11-03 16:22:53] INFO:   unique_processids: 376
[2025-11-03 16:22:53] INFO:   sequences_present: 376
[2025-11-03 16:22:53] INFO:   sequences_missing: 0
[2025-11-03 16:22:53] INFO:   empty_sequences: 0
[2025-11-03 16:22:53] INFO:   coords_present: 149
[2025-11-03 16:22:53] INFO:   coords_missing: 227
[2025-11-03 16:22:53] INFO:   centroid_coords: 36
[2025-11-03 16:22:53] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 16:22:53] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 16:22:53] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 16:23:24] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 16:23:25] INFO: Creating point geometries from coordinates
[2025-11-03 16:23:25] INFO: Creating point geometries for 0/340 samples with coordinates
[2025-11-03 16:23:25] INFO: Performing spatial join for 0/340 samples with valid coordinates
[2025-11-03 16:23:25] INFO: Assigned 340 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 16:23:25] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:23:53] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 16:23:53] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 16:23:53] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 16:23:53] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 16:24:00] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 16:24:00] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 16:24:00] INFO: Clustering complete: 18 clusters formed
[2025-11-03 16:27:37] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:27:37] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 16:27:37] INFO: Read 376 rows and 89 columns
[2025-11-03 16:27:37] INFO: Data quality summary:
[2025-11-03 16:27:37] INFO:   total_rows: 376
[2025-11-03 16:27:37] INFO:   total_columns: 89
[2025-11-03 16:27:37] INFO:   unique_processids: 376
[2025-11-03 16:27:37] INFO:   sequences_present: 376
[2025-11-03 16:27:37] INFO:   sequences_missing: 0
[2025-11-03 16:27:37] INFO:   empty_sequences: 0
[2025-11-03 16:27:37] INFO:   coords_present: 149
[2025-11-03 16:27:37] INFO:   coords_missing: 227
[2025-11-03 16:27:37] INFO:   centroid_coords: 36
[2025-11-03 16:27:37] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 16:27:37] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 16:27:37] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 16:28:06] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 16:28:06] INFO: Creating point geometries from coordinates
[2025-11-03 16:28:06] INFO: Creating point geometries for 0/340 samples with coordinates
[2025-11-03 16:28:06] INFO: Performing spatial join for 0/340 samples with valid coordinates
[2025-11-03 16:28:06] INFO: Assigned 340 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 16:28:07] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:28:34] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 16:28:34] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 16:28:34] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 16:28:34] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 16:28:41] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 16:28:42] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 16:28:42] INFO: Clustering complete: 18 clusters formed
[2025-11-03 16:32:51] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:32:51] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 16:32:51] INFO: Read 376 rows and 89 columns
[2025-11-03 16:32:51] INFO: Data quality summary:
[2025-11-03 16:32:51] INFO:   total_rows: 376
[2025-11-03 16:32:51] INFO:   total_columns: 89
[2025-11-03 16:32:51] INFO:   unique_processids: 376
[2025-11-03 16:32:51] INFO:   sequences_present: 376
[2025-11-03 16:32:51] INFO:   sequences_missing: 0
[2025-11-03 16:32:51] INFO:   empty_sequences: 0
[2025-11-03 16:32:51] INFO:   coords_present: 149
[2025-11-03 16:32:51] INFO:   coords_missing: 227
[2025-11-03 16:32:51] INFO:   centroid_coords: 36
[2025-11-03 16:32:51] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 16:32:51] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 16:32:51] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 16:33:26] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 16:33:26] INFO: Creating point geometries from coordinates
[2025-11-03 16:33:26] INFO: Creating point geometries for 0/340 samples with coordinates
[2025-11-03 16:33:26] INFO: Performing spatial join for 0/340 samples with valid coordinates
[2025-11-03 16:33:26] INFO: Assigned 340 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 16:33:26] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:33:56] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 16:33:56] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 16:33:57] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 16:33:57] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 16:34:04] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 16:34:04] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 16:34:04] INFO: Clustering complete: 18 clusters formed
[2025-11-03 16:34:04] INFO: ======================================================================
[2025-11-03 16:34:04] INFO: Starting genotype assignment workflow
[2025-11-03 16:34:04] INFO: ======================================================================
[2025-11-03 16:34:04] INFO: Using edlib for fast edit distance calculation
[2025-11-03 16:34:04] INFO: Step 1/6: Loading metadata from tests/output/02_filtered_metadata.tsv
[2025-11-03 16:34:04] INFO: Loaded 340 samples from metadata
[2025-11-03 16:34:04] INFO: Step 2/6: Loading consensus sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 16:34:04] INFO: Read 18 sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 16:34:04] INFO: Loaded 18 consensus groups
[2025-11-03 16:34:04] INFO: Step 3/6: Loading raw sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:34:04] INFO: Read 337 sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:34:04] INFO: Extracted 337 unique processids from FASTA
[2025-11-03 16:34:04] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 16:34:04] INFO: Prepared 340 assignment tasks
[2025-11-03 16:34:04] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 16:34:08] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:34:08] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:34:08] INFO: Completed genotype assignment for 340 samples
[2025-11-03 16:34:08] INFO: Step 6/6: Writing outputs
[2025-11-03 16:34:08] INFO: Wrote updated metadata to tests/output/Sphyrnidae_test_with_genotypes.tsv
[2025-11-03 16:34:08] INFO: Wrote diagnostics to tests/output/Sphyrnidae_test_diagnostics.csv
[2025-11-03 16:34:08] INFO: ======================================================================
[2025-11-03 16:34:08] INFO: Genotype assignment summary:
[2025-11-03 16:34:08] INFO:   Total samples: 340
[2025-11-03 16:34:08] INFO:   Successfully assigned: 285 (83.8%)
[2025-11-03 16:34:08] INFO:   Unassigned: 55 (16.2%)
[2025-11-03 16:34:08] INFO:     - No sequence in FASTA: 3
[2025-11-03 16:34:08] INFO:     - Below identity threshold: 52
[2025-11-03 16:34:08] INFO:   Diagnostic flags:
[2025-11-03 16:34:08] INFO:     - Ties (ambiguous): 43
[2025-11-03 16:34:08] INFO:     - Low confidence: 45
[2025-11-03 16:34:08] INFO: ======================================================================
[2025-11-03 16:53:06] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:53:06] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 16:53:06] INFO: Read 376 rows and 89 columns
[2025-11-03 16:53:06] INFO: Data quality summary:
[2025-11-03 16:53:06] INFO:   total_rows: 376
[2025-11-03 16:53:06] INFO:   total_columns: 89
[2025-11-03 16:53:06] INFO:   unique_processids: 376
[2025-11-03 16:53:06] INFO:   sequences_present: 376
[2025-11-03 16:53:06] INFO:   sequences_missing: 0
[2025-11-03 16:53:06] INFO:   empty_sequences: 0
[2025-11-03 16:53:06] INFO:   coords_present: 149
[2025-11-03 16:53:06] INFO:   coords_missing: 227
[2025-11-03 16:53:06] INFO:   centroid_coords: 36
[2025-11-03 16:53:06] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 16:53:06] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 16:53:06] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 16:53:45] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 16:53:45] INFO: Creating point geometries from coordinates
[2025-11-03 16:53:45] INFO: Creating point geometries for 113/340 samples with coordinates
[2025-11-03 16:53:45] INFO: Performing spatial join for 113/340 samples with valid coordinates
[2025-11-03 16:53:46] INFO: Spatial join results: 71 assigned to basins, 42 outside all basins
[2025-11-03 16:53:46] WARNING: 37.2% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-03 16:53:46] INFO: Assigned 269 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 16:53:46] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:54:16] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 16:54:16] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 16:54:17] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 16:54:17] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 16:54:24] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 16:54:24] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 16:54:24] INFO: Clustering complete: 18 clusters formed
[2025-11-03 16:54:25] INFO: ======================================================================
[2025-11-03 16:54:25] INFO: Starting genotype assignment workflow
[2025-11-03 16:54:25] INFO: ======================================================================
[2025-11-03 16:54:25] INFO: Using edlib for fast edit distance calculation
[2025-11-03 16:54:25] INFO: Step 1/6: Loading metadata from tests/output/02_filtered_metadata.tsv
[2025-11-03 16:54:25] INFO: Loaded 340 samples from metadata
[2025-11-03 16:54:25] INFO: Step 2/6: Loading consensus sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 16:54:25] INFO: Read 18 sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 16:54:25] INFO: Loaded 18 consensus groups
[2025-11-03 16:54:25] INFO: Step 3/6: Loading raw sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:54:25] INFO: Read 337 sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 16:54:25] INFO: Extracted 337 unique processids from FASTA
[2025-11-03 16:54:25] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 16:54:25] INFO: Prepared 340 assignment tasks
[2025-11-03 16:54:25] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 16:54:29] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:54:29] INFO: Logging to file: tests/test_run.log
[2025-11-03 16:54:30] INFO: Completed genotype assignment for 340 samples
[2025-11-03 16:54:30] INFO: Step 6/6: Writing outputs
[2025-11-03 16:54:30] INFO: Wrote updated metadata to tests/output/Sphyrnidae_test_with_genotypes.tsv
[2025-11-03 16:54:30] INFO: Wrote diagnostics to tests/output/Sphyrnidae_test_diagnostics.csv
[2025-11-03 16:54:30] INFO: ======================================================================
[2025-11-03 16:54:30] INFO: Genotype assignment summary:
[2025-11-03 16:54:30] INFO:   Total samples: 340
[2025-11-03 16:54:30] INFO:   Successfully assigned: 285 (83.8%)
[2025-11-03 16:54:30] INFO:   Unassigned: 55 (16.2%)
[2025-11-03 16:54:30] INFO:     - No sequence in FASTA: 3
[2025-11-03 16:54:30] INFO:     - Below identity threshold: 52
[2025-11-03 16:54:30] INFO:   Diagnostic flags:
[2025-11-03 16:54:30] INFO:     - Ties (ambiguous): 43
[2025-11-03 16:54:30] INFO:     - Low confidence: 45
[2025-11-03 16:54:30] INFO: ======================================================================
[2025-11-03 19:53:58] INFO: Logging to file: tests/test_run.log
[2025-11-03 19:53:58] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 19:53:58] INFO: Read 376 rows and 89 columns
[2025-11-03 19:53:58] INFO: Data quality summary:
[2025-11-03 19:53:58] INFO:   total_rows: 376
[2025-11-03 19:53:58] INFO:   total_columns: 89
[2025-11-03 19:53:58] INFO:   unique_processids: 376
[2025-11-03 19:53:58] INFO:   sequences_present: 376
[2025-11-03 19:53:58] INFO:   sequences_missing: 0
[2025-11-03 19:53:58] INFO:   empty_sequences: 0
[2025-11-03 19:53:58] INFO:   coords_present: 149
[2025-11-03 19:53:58] INFO:   coords_missing: 227
[2025-11-03 19:53:58] INFO:   centroid_coords: 36
[2025-11-03 19:53:58] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 19:53:58] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 19:53:58] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 19:54:29] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 19:54:29] INFO: Creating point geometries from coordinates
[2025-11-03 19:54:29] INFO: Creating point geometries for 113/340 samples with coordinates
[2025-11-03 19:54:29] INFO: Performing spatial join for 113/340 samples with valid coordinates
[2025-11-03 19:54:29] INFO: Spatial join results: 71 assigned to basins, 42 outside all basins
[2025-11-03 19:54:29] WARNING: 37.2% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-03 19:54:29] INFO: Assigned 269 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 19:54:29] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 19:54:58] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 19:54:58] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 19:54:58] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 19:54:58] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 19:55:05] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 19:55:05] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 19:55:05] INFO: Clustering complete: 18 clusters formed
[2025-11-03 19:55:06] INFO: ======================================================================
[2025-11-03 19:55:06] INFO: Starting genotype assignment workflow
[2025-11-03 19:55:06] INFO: ======================================================================
[2025-11-03 19:55:06] INFO: Using edlib for fast edit distance calculation
[2025-11-03 19:55:06] INFO: Step 1/6: Loading metadata from tests/output/02_filtered_metadata.tsv
[2025-11-03 19:55:06] INFO: Loaded 340 samples from metadata
[2025-11-03 19:55:06] INFO: Step 2/6: Loading consensus sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 19:55:06] INFO: Read 18 sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 19:55:06] INFO: Loaded 18 consensus groups
[2025-11-03 19:55:06] INFO: Step 3/6: Loading raw sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 19:55:06] INFO: Read 337 sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 19:55:06] INFO: Extracted 337 unique processids from FASTA
[2025-11-03 19:55:06] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 19:55:06] INFO: Prepared 340 assignment tasks
[2025-11-03 19:55:06] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 19:55:09] INFO: Logging to file: tests/test_run.log
[2025-11-03 19:55:09] INFO: Logging to file: tests/test_run.log
[2025-11-03 19:55:09] INFO: Completed genotype assignment for 340 samples
[2025-11-03 19:55:09] INFO: Step 6/6: Writing outputs
[2025-11-03 19:55:09] INFO: Wrote updated metadata to tests/output/Sphyrnidae_test_with_genotypes.tsv
[2025-11-03 19:55:09] INFO: Wrote diagnostics to tests/output/Sphyrnidae_test_diagnostics.csv
[2025-11-03 19:55:09] INFO: ======================================================================
[2025-11-03 19:55:09] INFO: Genotype assignment summary:
[2025-11-03 19:55:09] INFO:   Total samples: 340
[2025-11-03 19:55:09] INFO:   Successfully assigned: 285 (83.8%)
[2025-11-03 19:55:09] INFO:   Unassigned: 55 (16.2%)
[2025-11-03 19:55:09] INFO:     - No sequence in FASTA: 3
[2025-11-03 19:55:09] INFO:     - Below identity threshold: 52
[2025-11-03 19:55:09] INFO:   Diagnostic flags:
[2025-11-03 19:55:09] INFO:     - Ties (ambiguous): 43
[2025-11-03 19:55:09] INFO:     - Low confidence: 45
[2025-11-03 19:55:09] INFO: ======================================================================
[2025-11-03 20:02:07] INFO: Logging to file: tests/test_run.log
[2025-11-03 20:02:07] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 20:02:07] INFO: Read 376 rows and 89 columns
[2025-11-03 20:02:07] INFO: Data quality summary:
[2025-11-03 20:02:07] INFO:   total_rows: 376
[2025-11-03 20:02:07] INFO:   total_columns: 89
[2025-11-03 20:02:07] INFO:   unique_processids: 376
[2025-11-03 20:02:07] INFO:   sequences_present: 376
[2025-11-03 20:02:07] INFO:   sequences_missing: 0
[2025-11-03 20:02:07] INFO:   empty_sequences: 0
[2025-11-03 20:02:07] INFO:   coords_present: 149
[2025-11-03 20:02:07] INFO:   coords_missing: 227
[2025-11-03 20:02:07] INFO:   centroid_coords: 36
[2025-11-03 20:02:07] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 20:02:07] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 20:02:07] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 20:02:34] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 20:02:34] INFO: Creating point geometries from coordinates
[2025-11-03 20:02:34] INFO: Creating point geometries for 113/340 samples with coordinates
[2025-11-03 20:02:35] INFO: Performing spatial join for 113/340 samples with valid coordinates
[2025-11-03 20:02:35] INFO: Spatial join results: 71 assigned to basins, 42 outside all basins
[2025-11-03 20:02:35] WARNING: 37.2% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-03 20:02:35] INFO: Assigned 269 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 20:02:35] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 20:03:01] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 20:03:01] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 20:03:01] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 20:03:01] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 20:03:08] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 20:03:08] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 20:03:08] INFO: Clustering complete: 18 clusters formed
[2025-11-03 20:03:08] INFO: ======================================================================
[2025-11-03 20:03:08] INFO: Starting genotype assignment workflow
[2025-11-03 20:03:08] INFO: ======================================================================
[2025-11-03 20:03:08] INFO: Using edlib for fast edit distance calculation
[2025-11-03 20:03:08] INFO: Step 1/6: Loading metadata from tests/output/02_filtered_metadata.tsv
[2025-11-03 20:03:08] INFO: Loaded 340 samples from metadata
[2025-11-03 20:03:08] INFO: Step 2/6: Loading consensus sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 20:03:08] INFO: Read 18 sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 20:03:08] INFO: Loaded 18 consensus groups
[2025-11-03 20:03:08] INFO: Step 3/6: Loading raw sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 20:03:08] INFO: Read 337 sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 20:03:08] INFO: Extracted 337 unique processids from FASTA
[2025-11-03 20:03:08] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 20:03:08] INFO: Prepared 340 assignment tasks
[2025-11-03 20:03:08] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 20:03:12] INFO: Logging to file: tests/test_run.log
[2025-11-03 20:03:12] INFO: Logging to file: tests/test_run.log
[2025-11-03 20:03:12] INFO: Completed genotype assignment for 340 samples
[2025-11-03 20:03:12] INFO: Step 6/6: Writing outputs
[2025-11-03 20:03:12] INFO: Wrote updated metadata to tests/output/Sphyrnidae_test_with_genotypes.tsv
[2025-11-03 20:03:12] INFO: Wrote diagnostics to tests/output/Sphyrnidae_test_diagnostics.csv
[2025-11-03 20:03:12] INFO: ======================================================================
[2025-11-03 20:03:12] INFO: Genotype assignment summary:
[2025-11-03 20:03:12] INFO:   Total samples: 340
[2025-11-03 20:03:12] INFO:   Successfully assigned: 285 (83.8%)
[2025-11-03 20:03:12] INFO:   Unassigned: 55 (16.2%)
[2025-11-03 20:03:12] INFO:     - No sequence in FASTA: 3
[2025-11-03 20:03:12] INFO:     - Below identity threshold: 52
[2025-11-03 20:03:12] INFO:   Diagnostic flags:
[2025-11-03 20:03:12] INFO:     - Ties (ambiguous): 43
[2025-11-03 20:03:12] INFO:     - Low confidence: 45
[2025-11-03 20:03:12] INFO: ======================================================================
[2025-11-03 20:13:59] INFO: Logging to file: tests/test_run.log
[2025-11-03 20:13:59] INFO: Reading BOLD TSV file: tests/data/Sphyrnidae_test.tsv
[2025-11-03 20:13:59] INFO: Read 376 rows and 89 columns
[2025-11-03 20:13:59] INFO: Data quality summary:
[2025-11-03 20:13:59] INFO:   total_rows: 376
[2025-11-03 20:13:59] INFO:   total_columns: 89
[2025-11-03 20:13:59] INFO:   unique_processids: 376
[2025-11-03 20:13:59] INFO:   sequences_present: 376
[2025-11-03 20:13:59] INFO:   sequences_missing: 0
[2025-11-03 20:13:59] INFO:   empty_sequences: 0
[2025-11-03 20:13:59] INFO:   coords_present: 149
[2025-11-03 20:13:59] INFO:   coords_missing: 227
[2025-11-03 20:13:59] INFO:   centroid_coords: 36
[2025-11-03 20:13:59] INFO: Excluded 36 samples with centroid coordinates
[2025-11-03 20:13:59] INFO: Coordinate filtering: 340/376 samples retained (90.4%), 36 excluded
[2025-11-03 20:14:00] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 20:14:27] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 20:14:27] INFO: Creating point geometries from coordinates
[2025-11-03 20:14:27] INFO: Creating point geometries for 113/340 samples with coordinates
[2025-11-03 20:14:27] INFO: Performing spatial join for 113/340 samples with valid coordinates
[2025-11-03 20:14:27] INFO: Spatial join results: 71 assigned to basins, 42 outside all basins
[2025-11-03 20:14:27] WARNING: 37.2% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-03 20:14:27] INFO: Assigned 269 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 20:14:28] INFO: Running MAFFT alignment: mafft --auto tests/output/Sphyrnidae_test.fasta
[2025-11-03 20:14:54] INFO: MAFFT alignment completed: tests/output/dereplication/Sphyrnidae_test_aligned.fasta
[2025-11-03 20:14:54] INFO: Running trimAl: trimal -in tests/output/dereplication/Sphyrnidae_test_aligned.fasta -out tests/output/dereplication/Sphyrnidae_test_trimmed.fasta -automated1
[2025-11-03 20:14:55] INFO: trimAl completed: tests/output/dereplication/Sphyrnidae_test_trimmed.fasta
[2025-11-03 20:14:55] INFO: Calculating pairwise distances for 337 sequences
[2025-11-03 20:15:01] INFO: Distance calculation complete: 56616 pairwise distances
[2025-11-03 20:15:01] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 20:15:01] INFO: Clustering complete: 18 clusters formed
[2025-11-03 20:15:01] INFO: ======================================================================
[2025-11-03 20:15:01] INFO: Starting genotype assignment workflow
[2025-11-03 20:15:01] INFO: ======================================================================
[2025-11-03 20:15:01] INFO: Using edlib for fast edit distance calculation
[2025-11-03 20:15:01] INFO: Step 1/6: Loading metadata from tests/output/02_filtered_metadata.tsv
[2025-11-03 20:15:01] INFO: Loaded 340 samples from metadata
[2025-11-03 20:15:01] INFO: Step 2/6: Loading consensus sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 20:15:01] INFO: Read 18 sequences from tests/output/Sphyrnidae_test_consensus.fasta
[2025-11-03 20:15:01] INFO: Loaded 18 consensus groups
[2025-11-03 20:15:01] INFO: Step 3/6: Loading raw sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 20:15:01] INFO: Read 337 sequences from tests/output/Sphyrnidae_test.fasta
[2025-11-03 20:15:01] INFO: Extracted 337 unique processids from FASTA
[2025-11-03 20:15:01] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 20:15:01] INFO: Prepared 340 assignment tasks
[2025-11-03 20:15:01] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 20:15:04] INFO: Logging to file: tests/test_run.log
[2025-11-03 20:15:04] INFO: Logging to file: tests/test_run.log
[2025-11-03 20:15:04] INFO: Completed genotype assignment for 340 samples
[2025-11-03 20:15:04] INFO: Step 6/6: Writing outputs
[2025-11-03 20:15:04] INFO: Wrote updated metadata to tests/output/Sphyrnidae_test_with_genotypes.tsv
[2025-11-03 20:15:04] INFO: Wrote diagnostics to tests/output/Sphyrnidae_test_diagnostics.csv
[2025-11-03 20:15:04] INFO: ======================================================================
[2025-11-03 20:15:04] INFO: Genotype assignment summary:
[2025-11-03 20:15:04] INFO:   Total samples: 340
[2025-11-03 20:15:04] INFO:   Successfully assigned: 285 (83.8%)
[2025-11-03 20:15:04] INFO:   Unassigned: 55 (16.2%)
[2025-11-03 20:15:04] INFO:     - No sequence in FASTA: 3
[2025-11-03 20:15:04] INFO:     - Below identity threshold: 52
[2025-11-03 20:15:04] INFO:   Diagnostic flags:
[2025-11-03 20:15:04] INFO:     - Ties (ambiguous): 43
[2025-11-03 20:15:04] INFO:     - Low confidence: 45
[2025-11-03 20:15:04] INFO: ======================================================================
[2025-11-03 22:51:48] INFO: Logging to file: tests/test_run.log
[2025-11-03 22:51:48] INFO: Reading BOLD TSV file: tests/data/Crassostrea.tsv
[2025-11-03 22:51:48] INFO: Read 941 rows and 84 columns
[2025-11-03 22:51:49] ERROR: Found 59 duplicate processids. Examples: ['GBMTG1362-16', 'GBMTG1362-16', 'GBMTG1362-16', 'GBMTG1362-16', 'GBMTG1362-16']
[2025-11-03 22:56:05] INFO: Logging to file: tests/test_run.log
[2025-11-03 22:56:05] INFO: Reading BOLD TSV file: tests/data/Crassostrea.tsv
[2025-11-03 22:56:05] INFO: Read 882 rows and 84 columns
[2025-11-03 22:56:05] INFO: Data quality summary:
[2025-11-03 22:56:05] INFO:   total_rows: 882
[2025-11-03 22:56:05] INFO:   total_columns: 84
[2025-11-03 22:56:05] INFO:   unique_processids: 882
[2025-11-03 22:56:05] INFO:   sequences_present: 882
[2025-11-03 22:56:05] INFO:   sequences_missing: 0
[2025-11-03 22:56:05] INFO:   empty_sequences: 0
[2025-11-03 22:56:05] INFO:   coords_present: 195
[2025-11-03 22:56:05] INFO:   coords_missing: 687
[2025-11-03 22:56:05] INFO:   centroid_coords: 86
[2025-11-03 22:56:05] INFO: Excluded 86 samples with centroid coordinates
[2025-11-03 22:56:05] INFO: Coordinate filtering: 796/882 samples retained (90.2%), 86 excluded
[2025-11-03 22:56:05] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 22:56:31] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 22:56:31] INFO: Creating point geometries from coordinates
[2025-11-03 22:56:31] INFO: Creating point geometries for 109/796 samples with coordinates
[2025-11-03 22:56:31] INFO: Performing spatial join for 109/796 samples with valid coordinates
[2025-11-03 22:56:32] INFO: Spatial join results: 51 assigned to basins, 58 outside all basins
[2025-11-03 22:56:32] WARNING: 53.2% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-03 22:56:32] INFO: Assigned 745 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 22:56:32] INFO: Running MAFFT alignment: mafft --auto tests/Crassostrea_output/Crassostrea.fasta
[2025-11-03 22:56:41] INFO: MAFFT alignment completed: tests/Crassostrea_output/dereplication/Crassostrea_aligned.fasta
[2025-11-03 22:56:41] INFO: Running trimAl: trimal -in tests/Crassostrea_output/dereplication/Crassostrea_aligned.fasta -out tests/Crassostrea_output/dereplication/Crassostrea_trimmed.fasta -automated1
[2025-11-03 22:56:45] INFO: trimAl completed: tests/Crassostrea_output/dereplication/Crassostrea_trimmed.fasta
[2025-11-03 22:56:45] INFO: Calculating pairwise distances for 783 sequences
[2025-11-03 22:57:16] INFO: Distance calculation complete: 306153 pairwise distances
[2025-11-03 22:57:16] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 22:57:16] INFO: Clustering complete: 55 clusters formed
[2025-11-03 22:57:16] INFO: ======================================================================
[2025-11-03 22:57:16] INFO: Starting genotype assignment workflow
[2025-11-03 22:57:16] INFO: ======================================================================
[2025-11-03 22:57:16] INFO: Using edlib for fast edit distance calculation
[2025-11-03 22:57:16] INFO: Step 1/6: Loading metadata from tests/Crassostrea_output/02_filtered_metadata.tsv
[2025-11-03 22:57:17] INFO: Loaded 796 samples from metadata
[2025-11-03 22:57:17] INFO: Step 2/6: Loading consensus sequences from tests/Crassostrea_output/Crassostrea_consensus.fasta
[2025-11-03 22:57:17] INFO: Read 55 sequences from tests/Crassostrea_output/Crassostrea_consensus.fasta
[2025-11-03 22:57:17] INFO: Loaded 55 consensus groups
[2025-11-03 22:57:17] INFO: Step 3/6: Loading raw sequences from tests/Crassostrea_output/Crassostrea.fasta
[2025-11-03 22:57:17] INFO: Read 783 sequences from tests/Crassostrea_output/Crassostrea.fasta
[2025-11-03 22:57:17] INFO: Extracted 783 unique processids from FASTA
[2025-11-03 22:57:17] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 22:57:17] INFO: Prepared 796 assignment tasks
[2025-11-03 22:57:17] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 22:57:20] INFO: Logging to file: tests/test_run.log
[2025-11-03 22:57:20] INFO: Logging to file: tests/test_run.log
[2025-11-03 22:57:21] INFO: Completed genotype assignment for 796 samples
[2025-11-03 22:57:21] INFO: Step 6/6: Writing outputs
[2025-11-03 22:57:21] INFO: Wrote updated metadata to tests/Crassostrea_output/Crassostrea_with_genotypes.tsv
[2025-11-03 22:57:21] INFO: Wrote diagnostics to tests/Crassostrea_output/Crassostrea_diagnostics.csv
[2025-11-03 22:57:21] INFO: ======================================================================
[2025-11-03 22:57:21] INFO: Genotype assignment summary:
[2025-11-03 22:57:21] INFO:   Total samples: 796
[2025-11-03 22:57:21] INFO:   Successfully assigned: 364 (45.7%)
[2025-11-03 22:57:21] INFO:   Unassigned: 432 (54.3%)
[2025-11-03 22:57:21] INFO:     - No sequence in FASTA: 13
[2025-11-03 22:57:21] INFO:     - Below identity threshold: 419
[2025-11-03 22:57:21] INFO:   Diagnostic flags:
[2025-11-03 22:57:21] INFO:     - Ties (ambiguous): 175
[2025-11-03 22:57:21] INFO:     - Low confidence: 100
[2025-11-03 22:57:21] INFO: ======================================================================
[2025-11-03 23:06:05] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:06:05] INFO: Reading BOLD TSV file: tests/data/Euprymna.tsv
[2025-11-03 23:06:05] INFO: Read 160 rows and 80 columns
[2025-11-03 23:06:05] INFO: Data quality summary:
[2025-11-03 23:06:05] INFO:   total_rows: 160
[2025-11-03 23:06:05] INFO:   total_columns: 80
[2025-11-03 23:06:05] INFO:   unique_processids: 160
[2025-11-03 23:06:05] INFO:   sequences_present: 160
[2025-11-03 23:06:05] INFO:   sequences_missing: 0
[2025-11-03 23:06:05] INFO:   empty_sequences: 0
[2025-11-03 23:06:05] INFO:   coords_present: 6
[2025-11-03 23:06:05] INFO:   coords_missing: 154
[2025-11-03 23:06:05] INFO:   centroid_coords: 0
[2025-11-03 23:06:05] INFO: Excluded 0 samples with centroid coordinates
[2025-11-03 23:06:05] INFO: Coordinate filtering: 160/160 samples retained (100.0%), 0 excluded
[2025-11-03 23:06:05] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 23:06:33] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 23:06:33] INFO: Creating point geometries from coordinates
[2025-11-03 23:06:33] INFO: Creating point geometries for 6/160 samples with coordinates
[2025-11-03 23:06:33] INFO: Performing spatial join for 6/160 samples with valid coordinates
[2025-11-03 23:06:33] INFO: Spatial join results: 6 assigned to basins, 0 outside all basins
[2025-11-03 23:06:33] INFO: Assigned 154 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 23:06:33] INFO: Running MAFFT alignment: mafft --auto tests/Euprymna_output/Euprymna.fasta
[2025-11-03 23:06:39] INFO: MAFFT alignment completed: tests/Euprymna_output/dereplication/Euprymna_aligned.fasta
[2025-11-03 23:06:39] INFO: Running trimAl: trimal -in tests/Euprymna_output/dereplication/Euprymna_aligned.fasta -out tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta -automated1
[2025-11-03 23:06:39] INFO: trimAl completed: tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta
[2025-11-03 23:06:39] INFO: Calculating pairwise distances for 159 sequences
[2025-11-03 23:06:40] INFO: Distance calculation complete: 12561 pairwise distances
[2025-11-03 23:06:40] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 23:06:40] INFO: Clustering complete: 31 clusters formed
[2025-11-03 23:06:40] INFO: ======================================================================
[2025-11-03 23:06:40] INFO: Starting genotype assignment workflow
[2025-11-03 23:06:40] INFO: ======================================================================
[2025-11-03 23:06:40] INFO: Using edlib for fast edit distance calculation
[2025-11-03 23:06:40] INFO: Step 1/6: Loading metadata from tests/Euprymna_output/02_filtered_metadata.tsv
[2025-11-03 23:06:40] INFO: Loaded 160 samples from metadata
[2025-11-03 23:06:40] INFO: Step 2/6: Loading consensus sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-03 23:06:40] INFO: Read 31 sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-03 23:06:40] INFO: Loaded 31 consensus groups
[2025-11-03 23:06:40] INFO: Step 3/6: Loading raw sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-03 23:06:40] INFO: Read 159 sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-03 23:06:40] INFO: Extracted 159 unique processids from FASTA
[2025-11-03 23:06:40] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 23:06:40] INFO: Prepared 160 assignment tasks
[2025-11-03 23:06:40] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 23:06:43] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:06:43] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:06:44] INFO: Completed genotype assignment for 160 samples
[2025-11-03 23:06:44] INFO: Step 6/6: Writing outputs
[2025-11-03 23:06:44] INFO: Wrote updated metadata to tests/Euprymna_output/Euprymna_with_genotypes.tsv
[2025-11-03 23:06:44] INFO: Wrote diagnostics to tests/Euprymna_output/Euprymna_diagnostics.csv
[2025-11-03 23:06:44] INFO: ======================================================================
[2025-11-03 23:06:44] INFO: Genotype assignment summary:
[2025-11-03 23:06:44] INFO:   Total samples: 160
[2025-11-03 23:06:44] INFO:   Successfully assigned: 74 (46.2%)
[2025-11-03 23:06:44] INFO:   Unassigned: 86 (53.8%)
[2025-11-03 23:06:44] INFO:     - No sequence in FASTA: 1
[2025-11-03 23:06:44] INFO:     - Below identity threshold: 85
[2025-11-03 23:06:44] INFO:   Diagnostic flags:
[2025-11-03 23:06:44] INFO:     - Ties (ambiguous): 39
[2025-11-03 23:06:44] INFO:     - Low confidence: 5
[2025-11-03 23:06:44] INFO: ======================================================================
[2025-11-03 23:12:38] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:12:38] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-03 23:12:38] INFO: Read 3204 rows and 90 columns
[2025-11-03 23:12:38] ERROR: Found 142 duplicate processids. Examples: ['ELAMB010-23', 'ELAMB011-23', 'ELAMB011-23', 'ELAMB012-23', 'ELAMB012-23']
[2025-11-03 23:15:47] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:15:47] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-03 23:15:47] INFO: Read 3068 rows and 90 columns
[2025-11-03 23:15:47] ERROR: Found 7 duplicate processids. Examples: ['ELAMB010-23', 'ELAMB011-23', 'ELAMB011-23', 'ELAMB012-23', 'ELAMB012-23']
[2025-11-03 23:17:05] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:17:05] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-03 23:17:05] INFO: Read 3061 rows and 90 columns
[2025-11-03 23:17:05] INFO: Data quality summary:
[2025-11-03 23:17:05] INFO:   total_rows: 3061
[2025-11-03 23:17:05] INFO:   total_columns: 90
[2025-11-03 23:17:05] INFO:   unique_processids: 3061
[2025-11-03 23:17:05] INFO:   sequences_present: 3060
[2025-11-03 23:17:05] INFO:   sequences_missing: 1
[2025-11-03 23:17:05] INFO:   empty_sequences: 0
[2025-11-03 23:17:05] INFO:   coords_present: 873
[2025-11-03 23:17:05] INFO:   coords_missing: 2188
[2025-11-03 23:17:05] INFO:   centroid_coords: 471
[2025-11-03 23:17:05] INFO: Excluded 471 samples with centroid coordinates
[2025-11-03 23:17:05] INFO: Coordinate filtering: 2590/3061 samples retained (84.6%), 471 excluded
[2025-11-03 23:17:05] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-03 23:17:31] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-03 23:17:31] INFO: Creating point geometries from coordinates
[2025-11-03 23:17:31] INFO: Creating point geometries for 402/2590 samples with coordinates
[2025-11-03 23:17:31] INFO: Performing spatial join for 402/2590 samples with valid coordinates
[2025-11-03 23:17:32] INFO: Spatial join results: 270 assigned to basins, 132 outside all basins
[2025-11-03 23:17:32] WARNING: 32.8% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-03 23:17:32] INFO: Assigned 2320 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-03 23:17:32] INFO: Running MAFFT alignment: mafft --auto tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-03 23:18:34] INFO: MAFFT alignment completed: tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta
[2025-11-03 23:18:34] INFO: Running trimAl: trimal -in tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta -out tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta -automated1
[2025-11-03 23:19:03] INFO: trimAl completed: tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta
[2025-11-03 23:19:03] INFO: Calculating pairwise distances for 2558 sequences
[2025-11-03 23:27:36] INFO: Distance calculation complete: 3270403 pairwise distances
[2025-11-03 23:27:37] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-03 23:27:37] INFO: Clustering complete: 85 clusters formed
[2025-11-03 23:27:42] INFO: ======================================================================
[2025-11-03 23:27:42] INFO: Starting genotype assignment workflow
[2025-11-03 23:27:42] INFO: ======================================================================
[2025-11-03 23:27:42] INFO: Using edlib for fast edit distance calculation
[2025-11-03 23:27:42] INFO: Step 1/6: Loading metadata from tests/Carcharhinus_output/02_filtered_metadata.tsv
[2025-11-03 23:27:42] INFO: Loaded 2590 samples from metadata
[2025-11-03 23:27:42] INFO: Step 2/6: Loading consensus sequences from tests/Carcharhinus_output/Carcharhinus_consensus.fasta
[2025-11-03 23:27:42] INFO: Read 85 sequences from tests/Carcharhinus_output/Carcharhinus_consensus.fasta
[2025-11-03 23:27:42] INFO: Loaded 85 consensus groups
[2025-11-03 23:27:42] INFO: Step 3/6: Loading raw sequences from tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-03 23:27:42] INFO: Read 2558 sequences from tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-03 23:27:42] INFO: Extracted 2558 unique processids from FASTA
[2025-11-03 23:27:42] INFO: Step 4/6: Preparing assignment tasks
[2025-11-03 23:27:42] INFO: Prepared 2590 assignment tasks
[2025-11-03 23:27:42] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-03 23:27:45] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:27:45] INFO: Logging to file: tests/test_run.log
[2025-11-03 23:28:02] INFO: Completed genotype assignment for 2590 samples
[2025-11-03 23:28:02] INFO: Step 6/6: Writing outputs
[2025-11-03 23:28:02] INFO: Wrote updated metadata to tests/Carcharhinus_output/Carcharhinus_with_genotypes.tsv
[2025-11-03 23:28:02] INFO: Wrote diagnostics to tests/Carcharhinus_output/Carcharhinus_diagnostics.csv
[2025-11-03 23:28:02] INFO: ======================================================================
[2025-11-03 23:28:02] INFO: Genotype assignment summary:
[2025-11-03 23:28:02] INFO:   Total samples: 2590
[2025-11-03 23:28:02] INFO:   Successfully assigned: 385 (14.9%)
[2025-11-03 23:28:02] INFO:   Unassigned: 2205 (85.1%)
[2025-11-03 23:28:02] INFO:     - No sequence in FASTA: 32
[2025-11-03 23:28:02] INFO:     - Below identity threshold: 2173
[2025-11-03 23:28:02] INFO:   Diagnostic flags:
[2025-11-03 23:28:02] INFO:     - Ties (ambiguous): 2096
[2025-11-03 23:28:02] INFO:     - Low confidence: 1
[2025-11-03 23:28:02] INFO: ======================================================================
[2025-11-04 06:38:33] INFO: Logging to file: tests/test_run.log
[2025-11-04 06:38:33] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-04 06:38:33] INFO: Read 3061 rows and 90 columns
[2025-11-04 06:38:33] INFO: Data quality summary:
[2025-11-04 06:38:33] INFO:   total_rows: 3061
[2025-11-04 06:38:33] INFO:   total_columns: 90
[2025-11-04 06:38:33] INFO:   unique_processids: 3061
[2025-11-04 06:38:33] INFO:   sequences_present: 3060
[2025-11-04 06:38:33] INFO:   sequences_missing: 1
[2025-11-04 06:38:33] INFO:   empty_sequences: 0
[2025-11-04 06:38:33] INFO:   coords_present: 873
[2025-11-04 06:38:33] INFO:   coords_missing: 2188
[2025-11-04 06:38:33] INFO:   centroid_coords: 471
[2025-11-04 06:38:33] INFO: Excluded 471 samples with centroid coordinates
[2025-11-04 06:38:33] INFO: Coordinate filtering: 2590/3061 samples retained (84.6%), 471 excluded
[2025-11-04 06:39:11] INFO: Logging to file: tests/test_run.log
[2025-11-04 06:39:11] INFO: Reading BOLD TSV file: tests/data/Crassostrea.tsv
[2025-11-04 06:39:11] INFO: Read 882 rows and 84 columns
[2025-11-04 06:39:11] INFO: Data quality summary:
[2025-11-04 06:39:11] INFO:   total_rows: 882
[2025-11-04 06:39:11] INFO:   total_columns: 84
[2025-11-04 06:39:11] INFO:   unique_processids: 882
[2025-11-04 06:39:11] INFO:   sequences_present: 882
[2025-11-04 06:39:11] INFO:   sequences_missing: 0
[2025-11-04 06:39:11] INFO:   empty_sequences: 0
[2025-11-04 06:39:11] INFO:   coords_present: 195
[2025-11-04 06:39:11] INFO:   coords_missing: 687
[2025-11-04 06:39:11] INFO:   centroid_coords: 86
[2025-11-04 06:39:11] INFO: Excluded 86 samples with centroid coordinates
[2025-11-04 06:39:11] INFO: Coordinate filtering: 796/882 samples retained (90.2%), 86 excluded
[2025-11-04 06:41:53] INFO: Logging to file: tests/test_run.log
[2025-11-04 06:41:53] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-04 06:41:53] INFO: Read 3061 rows and 90 columns
[2025-11-04 06:41:53] INFO: Data quality summary:
[2025-11-04 06:41:53] INFO:   total_rows: 3061
[2025-11-04 06:41:53] INFO:   total_columns: 90
[2025-11-04 06:41:53] INFO:   unique_processids: 3061
[2025-11-04 06:41:53] INFO:   sequences_present: 3060
[2025-11-04 06:41:53] INFO:   sequences_missing: 1
[2025-11-04 06:41:53] INFO:   empty_sequences: 0
[2025-11-04 06:41:53] INFO:   coords_present: 873
[2025-11-04 06:41:53] INFO:   coords_missing: 2188
[2025-11-04 06:41:53] INFO:   centroid_coords: 471
[2025-11-04 06:41:53] INFO: Excluded 471 samples with centroid coordinates
[2025-11-04 06:41:53] INFO: Coordinate filtering: 2590/3061 samples retained (84.6%), 471 excluded
[2025-11-04 06:41:53] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 06:42:24] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 06:42:24] INFO: Creating point geometries from coordinates
[2025-11-04 06:42:24] INFO: Creating point geometries for 402/2590 samples with coordinates
[2025-11-04 06:42:24] INFO: Performing spatial join for 402/2590 samples with valid coordinates
[2025-11-04 06:42:25] INFO: Spatial join results: 270 assigned to basins, 132 outside all basins
[2025-11-04 06:42:25] WARNING: 32.8% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-04 06:42:25] INFO: Assigned 2320 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 06:42:25] INFO: Running MAFFT alignment: mafft --auto tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 06:43:32] INFO: MAFFT alignment completed: tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta
[2025-11-04 06:43:32] INFO: Running trimAl: trimal -in tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta -out tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta -automated1
[2025-11-04 06:44:03] INFO: trimAl completed: tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta
[2025-11-04 06:44:03] INFO: Calculating pairwise distances for 2558 sequences
[2025-11-04 06:53:16] INFO: Distance calculation complete: 3270403 pairwise distances
[2025-11-04 06:53:16] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-04 06:53:16] INFO: Clustering complete: 85 clusters formed
[2025-11-04 06:53:22] INFO: ======================================================================
[2025-11-04 06:53:22] INFO: Starting genotype assignment workflow
[2025-11-04 06:53:22] INFO: ======================================================================
[2025-11-04 06:53:22] INFO: Using edlib for fast edit distance calculation
[2025-11-04 06:53:22] INFO: Step 1/6: Loading metadata from tests/Carcharhinus_output/02_filtered_metadata.tsv
[2025-11-04 06:53:22] INFO: Loaded 2590 samples from metadata
[2025-11-04 06:53:22] INFO: Step 2/6: Loading consensus sequences from tests/Carcharhinus_output/Carcharhinus_consensus.fasta
[2025-11-04 06:53:22] INFO: Read 85 sequences from tests/Carcharhinus_output/Carcharhinus_consensus.fasta
[2025-11-04 06:53:22] INFO: Loaded 85 consensus groups
[2025-11-04 06:53:22] INFO: Step 3/6: Loading raw sequences from tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 06:53:22] INFO: Read 2558 sequences from tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 06:53:22] INFO: Extracted 2558 unique processids from FASTA
[2025-11-04 06:53:22] INFO: Step 4/6: Preparing assignment tasks
[2025-11-04 06:53:22] INFO: Prepared 2590 assignment tasks
[2025-11-04 06:53:22] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-04 06:53:26] INFO: Logging to file: tests/test_run.log
[2025-11-04 06:53:26] INFO: Logging to file: tests/test_run.log
[2025-11-04 06:53:44] INFO: Completed genotype assignment for 2590 samples
[2025-11-04 06:53:44] INFO: Step 6/6: Writing outputs
[2025-11-04 06:53:44] INFO: Wrote updated metadata to tests/Carcharhinus_output/Carcharhinus_with_genotypes.tsv
[2025-11-04 06:53:44] INFO: Wrote diagnostics to tests/Carcharhinus_output/Carcharhinus_diagnostics.csv
[2025-11-04 06:53:44] INFO: ======================================================================
[2025-11-04 06:53:44] INFO: Genotype assignment summary:
[2025-11-04 06:53:44] INFO:   Total samples: 2590
[2025-11-04 06:53:44] INFO:   Successfully assigned: 385 (14.9%)
[2025-11-04 06:53:44] INFO:   Unassigned: 2205 (85.1%)
[2025-11-04 06:53:44] INFO:     - No sequence in FASTA: 32
[2025-11-04 06:53:44] INFO:     - Below identity threshold: 2173
[2025-11-04 06:53:44] INFO:   Diagnostic flags:
[2025-11-04 06:53:44] INFO:     - Ties (ambiguous): 2096
[2025-11-04 06:53:44] INFO:     - Low confidence: 1
[2025-11-04 06:53:44] INFO: ======================================================================
[2025-11-04 07:35:25] INFO: Logging to file: tests/test_run.log
[2025-11-04 07:37:41] INFO: Logging to file: tests/test_run.log
[2025-11-04 07:37:41] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-04 07:37:41] INFO: Read 3061 rows and 90 columns
[2025-11-04 07:37:41] INFO: Data quality summary:
[2025-11-04 07:37:41] INFO:   total_rows: 3061
[2025-11-04 07:37:41] INFO:   total_columns: 90
[2025-11-04 07:37:41] INFO:   unique_processids: 3061
[2025-11-04 07:37:41] INFO:   sequences_present: 3060
[2025-11-04 07:37:41] INFO:   sequences_missing: 1
[2025-11-04 07:37:41] INFO:   empty_sequences: 0
[2025-11-04 07:37:41] INFO:   coords_present: 873
[2025-11-04 07:37:41] INFO:   coords_missing: 2188
[2025-11-04 07:37:41] INFO:   centroid_coords: 471
[2025-11-04 07:37:42] INFO: Excluded 471 samples with centroid coordinates
[2025-11-04 07:37:42] INFO: Coordinate filtering: 2590/3061 samples retained (84.6%), 471 excluded
[2025-11-04 07:37:59] INFO: Logging to file: tests/test_run.log
[2025-11-04 07:37:59] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-04 07:37:59] INFO: Read 3061 rows and 90 columns
[2025-11-04 07:37:59] INFO: Data quality summary:
[2025-11-04 07:37:59] INFO:   total_rows: 3061
[2025-11-04 07:37:59] INFO:   total_columns: 90
[2025-11-04 07:37:59] INFO:   unique_processids: 3061
[2025-11-04 07:37:59] INFO:   sequences_present: 3060
[2025-11-04 07:37:59] INFO:   sequences_missing: 1
[2025-11-04 07:37:59] INFO:   empty_sequences: 0
[2025-11-04 07:37:59] INFO:   coords_present: 873
[2025-11-04 07:37:59] INFO:   coords_missing: 2188
[2025-11-04 07:37:59] INFO:   centroid_coords: 471
[2025-11-04 07:37:59] INFO: Excluded 471 samples with centroid coordinates
[2025-11-04 07:37:59] INFO: Coordinate filtering: 2590/3061 samples retained (84.6%), 471 excluded
[2025-11-04 07:37:59] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 07:38:28] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 07:38:28] INFO: Creating point geometries from coordinates
[2025-11-04 07:38:28] INFO: Creating point geometries for 402/2590 samples with coordinates
[2025-11-04 07:38:29] INFO: Performing spatial join for 402/2590 samples with valid coordinates
[2025-11-04 07:38:29] INFO: Spatial join results: 270 assigned to basins, 132 outside all basins
[2025-11-04 07:38:29] WARNING: 32.8% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-04 07:38:29] INFO: Assigned 2320 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 07:38:30] INFO: Running MAFFT alignment: mafft --auto tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 07:39:39] INFO: MAFFT alignment completed: tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta
[2025-11-04 07:39:39] INFO: Running trimAl: trimal -in tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta -out tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta -automated1
[2025-11-04 07:40:12] INFO: trimAl completed: tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta
[2025-11-04 07:40:12] INFO: Calculating pairwise distances for 2558 sequences
[2025-11-04 07:49:48] INFO: Distance calculation complete: 3270403 pairwise distances
[2025-11-04 07:49:48] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-04 07:49:49] INFO: Clustering complete: 85 clusters formed
[2025-11-04 07:49:55] INFO: ======================================================================
[2025-11-04 07:49:55] INFO: Starting genotype assignment workflow
[2025-11-04 07:49:55] INFO: ======================================================================
[2025-11-04 07:49:55] INFO: Using edlib for fast edit distance calculation
[2025-11-04 07:49:55] INFO: Step 1/6: Loading metadata from tests/Carcharhinus_output/02_filtered_metadata.tsv
[2025-11-04 07:49:55] INFO: Loaded 2590 samples from metadata
[2025-11-04 07:49:55] INFO: Step 2/6: Loading consensus sequences from tests/Carcharhinus_output/Carcharhinus_consensus.fasta
[2025-11-04 07:49:55] INFO: Read 85 sequences from tests/Carcharhinus_output/Carcharhinus_consensus.fasta
[2025-11-04 07:49:55] INFO: Loaded 85 consensus groups
[2025-11-04 07:49:55] INFO: Step 3/6: Loading raw sequences from tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 07:49:55] INFO: Read 2558 sequences from tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 07:49:55] INFO: Extracted 2558 unique processids from FASTA
[2025-11-04 07:49:55] INFO: Step 4/6: Preparing assignment tasks
[2025-11-04 07:49:55] INFO: Prepared 2590 assignment tasks
[2025-11-04 07:49:55] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-04 07:49:58] INFO: Logging to file: tests/test_run.log
[2025-11-04 07:49:58] INFO: Logging to file: tests/test_run.log
[2025-11-04 07:50:17] INFO: Completed genotype assignment for 2590 samples
[2025-11-04 07:50:17] INFO: Step 6/6: Writing outputs
[2025-11-04 07:50:17] INFO: Wrote updated metadata to tests/Carcharhinus_output/Carcharhinus_with_genotypes.tsv
[2025-11-04 07:50:17] INFO: Wrote diagnostics to tests/Carcharhinus_output/Carcharhinus_diagnostics.csv
[2025-11-04 07:50:17] INFO: ======================================================================
[2025-11-04 07:50:17] INFO: Genotype assignment summary:
[2025-11-04 07:50:17] INFO:   Total samples: 2590
[2025-11-04 07:50:17] INFO:   Successfully assigned: 452 (17.5%)
[2025-11-04 07:50:17] INFO:   Unassigned: 2138 (82.5%)
[2025-11-04 07:50:17] INFO:     - No sequence in FASTA: 32
[2025-11-04 07:50:17] INFO:     - Below identity threshold: 2106
[2025-11-04 07:50:17] INFO:   Diagnostic flags:
[2025-11-04 07:50:17] INFO:     - Ties (ambiguous): 2096
[2025-11-04 07:50:17] INFO:     - Low confidence: 0
[2025-11-04 07:50:17] INFO: ======================================================================
[2025-11-04 10:23:03] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:23:57] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:26:15] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:26:15] INFO: Reading BOLD TSV file: tests/data/Carcharhinus.tsv
[2025-11-04 10:26:15] INFO: Read 3061 rows and 90 columns
[2025-11-04 10:26:15] INFO: Data quality summary:
[2025-11-04 10:26:15] INFO:   total_rows: 3061
[2025-11-04 10:26:15] INFO:   total_columns: 90
[2025-11-04 10:26:15] INFO:   unique_processids: 3061
[2025-11-04 10:26:15] INFO:   sequences_present: 3060
[2025-11-04 10:26:15] INFO:   sequences_missing: 1
[2025-11-04 10:26:15] INFO:   empty_sequences: 0
[2025-11-04 10:26:15] INFO:   coords_present: 873
[2025-11-04 10:26:15] INFO:   coords_missing: 2188
[2025-11-04 10:26:15] INFO:   centroid_coords: 471
[2025-11-04 10:26:15] INFO: Excluded 471 samples with centroid coordinates
[2025-11-04 10:26:15] INFO: Coordinate filtering: 2590/3061 samples retained (84.6%), 471 excluded
[2025-11-04 10:26:16] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 10:26:42] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 10:26:42] INFO: Creating point geometries from coordinates
[2025-11-04 10:26:42] INFO: Creating point geometries for 402/2590 samples with coordinates
[2025-11-04 10:26:43] INFO: Performing spatial join for 402/2590 samples with valid coordinates
[2025-11-04 10:26:43] INFO: Spatial join results: 270 assigned to basins, 132 outside all basins
[2025-11-04 10:26:43] WARNING: 32.8% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-04 10:26:43] INFO: Assigned 2320 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 10:26:44] INFO: Running MAFFT alignment: mafft --auto tests/Carcharhinus_output/Carcharhinus.fasta
[2025-11-04 10:27:45] INFO: MAFFT alignment completed: tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta
[2025-11-04 10:27:45] INFO: Running trimAl: trimal -in tests/Carcharhinus_output/dereplication/Carcharhinus_aligned.fasta -out tests/Carcharhinus_output/dereplication/Carcharhinus_trimmed.fasta -automated1
[2025-11-04 10:28:31] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:28:31] INFO: Reading BOLD TSV file: tests/data/Euprymna.tsv
[2025-11-04 10:28:31] INFO: Read 160 rows and 80 columns
[2025-11-04 10:28:31] INFO: Data quality summary:
[2025-11-04 10:28:31] INFO:   total_rows: 160
[2025-11-04 10:28:31] INFO:   total_columns: 80
[2025-11-04 10:28:31] INFO:   unique_processids: 160
[2025-11-04 10:28:31] INFO:   sequences_present: 160
[2025-11-04 10:28:31] INFO:   sequences_missing: 0
[2025-11-04 10:28:31] INFO:   empty_sequences: 0
[2025-11-04 10:28:31] INFO:   coords_present: 6
[2025-11-04 10:28:31] INFO:   coords_missing: 154
[2025-11-04 10:28:31] INFO:   centroid_coords: 0
[2025-11-04 10:28:31] INFO: Excluded 0 samples with centroid coordinates
[2025-11-04 10:28:31] INFO: Coordinate filtering: 160/160 samples retained (100.0%), 0 excluded
[2025-11-04 10:28:31] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 10:28:57] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 10:28:57] INFO: Creating point geometries from coordinates
[2025-11-04 10:28:57] INFO: Creating point geometries for 6/160 samples with coordinates
[2025-11-04 10:28:57] INFO: Performing spatial join for 6/160 samples with valid coordinates
[2025-11-04 10:28:57] INFO: Spatial join results: 6 assigned to basins, 0 outside all basins
[2025-11-04 10:28:57] INFO: Assigned 154 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 10:28:57] INFO: Running MAFFT alignment: mafft --auto tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:29:02] INFO: MAFFT alignment completed: tests/Euprymna_output/dereplication/Euprymna_aligned.fasta
[2025-11-04 10:29:02] INFO: Running trimAl: trimal -in tests/Euprymna_output/dereplication/Euprymna_aligned.fasta -out tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta -automated1
[2025-11-04 10:29:03] INFO: trimAl completed: tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta
[2025-11-04 10:29:03] INFO: Calculating pairwise distances for 159 sequences
[2025-11-04 10:29:04] INFO: Distance calculation complete: 12561 pairwise distances
[2025-11-04 10:29:04] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-04 10:29:04] INFO: Clustering complete: 31 clusters formed
[2025-11-04 10:29:04] INFO: ======================================================================
[2025-11-04 10:29:04] INFO: Starting genotype assignment workflow
[2025-11-04 10:29:04] INFO: ======================================================================
[2025-11-04 10:29:04] INFO: Using edlib for fast edit distance calculation
[2025-11-04 10:29:04] INFO: Step 1/6: Loading metadata from tests/Euprymna_output/02_filtered_metadata.tsv
[2025-11-04 10:29:04] INFO: Loaded 160 samples from metadata
[2025-11-04 10:29:04] INFO: Step 2/6: Loading consensus sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:29:04] INFO: Read 31 sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:29:04] INFO: Loaded 31 consensus groups
[2025-11-04 10:29:04] INFO: Step 3/6: Loading raw sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:29:04] INFO: Read 159 sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:29:04] INFO: Extracted 159 unique processids from FASTA
[2025-11-04 10:29:04] INFO: Step 4/6: Preparing assignment tasks
[2025-11-04 10:29:04] INFO: Prepared 160 assignment tasks
[2025-11-04 10:29:04] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-04 10:29:07] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:29:07] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:29:07] INFO: Completed genotype assignment for 160 samples
[2025-11-04 10:29:07] INFO: Step 6/6: Writing outputs
[2025-11-04 10:29:07] INFO: Wrote updated metadata to tests/Euprymna_output/Euprymna_with_genotypes.tsv
[2025-11-04 10:29:07] INFO: Wrote diagnostics to tests/Euprymna_output/Euprymna_diagnostics.csv
[2025-11-04 10:29:07] INFO: ======================================================================
[2025-11-04 10:29:07] INFO: Genotype assignment summary:
[2025-11-04 10:29:07] INFO:   Total samples: 160
[2025-11-04 10:29:07] INFO:   Successfully assigned: 92 (57.5%)
[2025-11-04 10:29:07] INFO:   Unassigned: 68 (42.5%)
[2025-11-04 10:29:07] INFO:     - No sequence in FASTA: 1
[2025-11-04 10:29:07] INFO:     - Below identity threshold: 67
[2025-11-04 10:29:07] INFO:   Diagnostic flags:
[2025-11-04 10:29:07] INFO:     - Ties (ambiguous): 39
[2025-11-04 10:29:07] INFO:     - Low confidence: 0
[2025-11-04 10:29:07] INFO: ======================================================================
[2025-11-04 10:36:49] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:36:49] INFO: Reading BOLD TSV file: tests/data/Euprymna.tsv
[2025-11-04 10:36:49] INFO: Read 160 rows and 80 columns
[2025-11-04 10:36:49] INFO: Data quality summary:
[2025-11-04 10:36:49] INFO:   total_rows: 160
[2025-11-04 10:36:49] INFO:   total_columns: 80
[2025-11-04 10:36:49] INFO:   unique_processids: 160
[2025-11-04 10:36:49] INFO:   sequences_present: 160
[2025-11-04 10:36:49] INFO:   sequences_missing: 0
[2025-11-04 10:36:49] INFO:   empty_sequences: 0
[2025-11-04 10:36:49] INFO:   coords_present: 6
[2025-11-04 10:36:49] INFO:   coords_missing: 154
[2025-11-04 10:36:49] INFO:   centroid_coords: 0
[2025-11-04 10:36:49] INFO: Excluded 0 samples with centroid coordinates
[2025-11-04 10:36:49] INFO: Coordinate filtering: 160/160 samples retained (100.0%), 0 excluded
[2025-11-04 10:36:49] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 10:37:21] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 10:37:21] INFO: Creating point geometries from coordinates
[2025-11-04 10:37:21] INFO: Creating point geometries for 6/160 samples with coordinates
[2025-11-04 10:37:21] INFO: Performing spatial join for 6/160 samples with valid coordinates
[2025-11-04 10:37:21] INFO: Spatial join results: 6 assigned to basins, 0 outside all basins
[2025-11-04 10:37:21] INFO: Assigned 154 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 10:37:21] INFO: Running MAFFT alignment: mafft --auto tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:37:27] INFO: MAFFT alignment completed: tests/Euprymna_output/dereplication/Euprymna_aligned.fasta
[2025-11-04 10:37:27] INFO: Running trimAl: trimal -in tests/Euprymna_output/dereplication/Euprymna_aligned.fasta -out tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta -automated1
[2025-11-04 10:37:28] INFO: trimAl completed: tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta
[2025-11-04 10:37:28] INFO: Calculating pairwise distances for 159 sequences
[2025-11-04 10:37:29] INFO: Distance calculation complete: 12561 pairwise distances
[2025-11-04 10:37:29] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-04 10:37:29] INFO: Clustering complete: 31 clusters formed
[2025-11-04 10:37:29] INFO: ======================================================================
[2025-11-04 10:37:29] INFO: Starting genotype assignment workflow
[2025-11-04 10:37:29] INFO: ======================================================================
[2025-11-04 10:37:29] INFO: Using edlib for fast edit distance calculation
[2025-11-04 10:37:29] INFO: Step 1/6: Loading metadata from tests/Euprymna_output/02_filtered_metadata.tsv
[2025-11-04 10:37:29] INFO: Loaded 160 samples from metadata
[2025-11-04 10:37:29] INFO: Step 2/6: Loading consensus sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:37:29] INFO: Read 31 sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:37:29] INFO: Loaded 31 consensus groups
[2025-11-04 10:37:29] INFO: Step 3/6: Loading raw sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:37:29] INFO: Read 159 sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:37:29] INFO: Extracted 159 unique processids from FASTA
[2025-11-04 10:37:29] INFO: Step 4/6: Preparing assignment tasks
[2025-11-04 10:37:29] INFO: Prepared 160 assignment tasks
[2025-11-04 10:37:29] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-04 10:37:33] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:37:33] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:37:33] INFO: Completed genotype assignment for 160 samples
[2025-11-04 10:37:33] INFO: Step 6/6: Writing outputs
[2025-11-04 10:37:33] INFO: Wrote updated metadata to tests/Euprymna_output/Euprymna_with_genotypes.tsv
[2025-11-04 10:37:33] INFO: Wrote diagnostics to tests/Euprymna_output/Euprymna_diagnostics.csv
[2025-11-04 10:37:33] INFO: ======================================================================
[2025-11-04 10:37:33] INFO: Genotype assignment summary:
[2025-11-04 10:37:33] INFO:   Total samples: 160
[2025-11-04 10:37:33] INFO:   Successfully assigned: 92 (57.5%)
[2025-11-04 10:37:33] INFO:   Unassigned: 68 (42.5%)
[2025-11-04 10:37:33] INFO:     - No sequence in FASTA: 1
[2025-11-04 10:37:33] INFO:     - Below identity threshold: 67
[2025-11-04 10:37:33] INFO:   Diagnostic flags:
[2025-11-04 10:37:33] INFO:     - Ties (ambiguous): 39
[2025-11-04 10:37:33] INFO:     - Low confidence: 0
[2025-11-04 10:37:33] INFO: ======================================================================
[2025-11-04 10:42:34] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:42:34] INFO: Reading BOLD TSV file: tests/data/Euprymna.tsv
[2025-11-04 10:42:34] INFO: Read 160 rows and 80 columns
[2025-11-04 10:42:34] INFO: Data quality summary:
[2025-11-04 10:42:34] INFO:   total_rows: 160
[2025-11-04 10:42:34] INFO:   total_columns: 80
[2025-11-04 10:42:34] INFO:   unique_processids: 160
[2025-11-04 10:42:34] INFO:   sequences_present: 160
[2025-11-04 10:42:34] INFO:   sequences_missing: 0
[2025-11-04 10:42:34] INFO:   empty_sequences: 0
[2025-11-04 10:42:34] INFO:   coords_present: 6
[2025-11-04 10:42:34] INFO:   coords_missing: 154
[2025-11-04 10:42:34] INFO:   centroid_coords: 0
[2025-11-04 10:42:34] INFO: Excluded 0 samples with centroid coordinates
[2025-11-04 10:42:34] INFO: Coordinate filtering: 160/160 samples retained (100.0%), 0 excluded
[2025-11-04 10:42:34] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 10:43:03] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 10:43:03] INFO: Creating point geometries from coordinates
[2025-11-04 10:43:03] INFO: Creating point geometries for 6/160 samples with coordinates
[2025-11-04 10:43:03] INFO: Performing spatial join for 6/160 samples with valid coordinates
[2025-11-04 10:43:04] INFO: Spatial join results: 6 assigned to basins, 0 outside all basins
[2025-11-04 10:43:04] INFO: Assigned 154 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 10:43:04] INFO: Running MAFFT alignment: mafft --auto tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:43:10] INFO: MAFFT alignment completed: tests/Euprymna_output/dereplication/Euprymna_aligned.fasta
[2025-11-04 10:43:10] INFO: Running trimAl: trimal -in tests/Euprymna_output/dereplication/Euprymna_aligned.fasta -out tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta -automated1
[2025-11-04 10:43:10] INFO: trimAl completed: tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta
[2025-11-04 10:43:10] INFO: Calculating pairwise distances for 159 sequences
[2025-11-04 10:43:12] INFO: Distance calculation complete: 12561 pairwise distances
[2025-11-04 10:43:12] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-04 10:43:12] INFO: Clustering complete: 31 clusters formed
[2025-11-04 10:43:12] INFO: ======================================================================
[2025-11-04 10:43:12] INFO: Starting genotype assignment workflow
[2025-11-04 10:43:12] INFO: ======================================================================
[2025-11-04 10:43:12] INFO: Using edlib for fast edit distance calculation
[2025-11-04 10:43:12] INFO: Step 1/6: Loading metadata from tests/Euprymna_output/02_filtered_metadata.tsv
[2025-11-04 10:43:12] INFO: Loaded 160 samples from metadata
[2025-11-04 10:43:12] INFO: Step 2/6: Loading consensus sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:43:12] INFO: Read 31 sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:43:12] INFO: Loaded 31 consensus groups
[2025-11-04 10:43:12] INFO: Step 3/6: Loading raw sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:43:12] INFO: Read 159 sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:43:12] INFO: Extracted 159 unique processids from FASTA
[2025-11-04 10:43:12] INFO: Step 4/6: Preparing assignment tasks
[2025-11-04 10:43:12] INFO: Prepared 160 assignment tasks
[2025-11-04 10:43:12] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-04 10:43:15] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:43:15] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:43:15] INFO: Completed genotype assignment for 160 samples
[2025-11-04 10:43:15] INFO: Step 6/6: Writing outputs
[2025-11-04 10:43:15] INFO: Wrote updated metadata to tests/Euprymna_output/Euprymna_with_genotypes.tsv
[2025-11-04 10:43:15] INFO: Wrote diagnostics to tests/Euprymna_output/Euprymna_diagnostics.csv
[2025-11-04 10:43:15] INFO: ======================================================================
[2025-11-04 10:43:15] INFO: Genotype assignment summary:
[2025-11-04 10:43:15] INFO:   Total samples: 160
[2025-11-04 10:43:15] INFO:   Successfully assigned: 92 (57.5%)
[2025-11-04 10:43:15] INFO:   Unassigned: 68 (42.5%)
[2025-11-04 10:43:15] INFO:     - No sequence in FASTA: 1
[2025-11-04 10:43:15] INFO:     - Below identity threshold: 67
[2025-11-04 10:43:15] INFO:   Diagnostic flags:
[2025-11-04 10:43:15] INFO:     - Ties (ambiguous): 39
[2025-11-04 10:43:15] INFO:     - Low confidence: 0
[2025-11-04 10:43:15] INFO: ======================================================================
[2025-11-04 10:57:21] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:57:21] INFO: Reading BOLD TSV file: tests/data/Euprymna.tsv
[2025-11-04 10:57:21] INFO: Read 160 rows and 80 columns
[2025-11-04 10:57:21] INFO: Data quality summary:
[2025-11-04 10:57:21] INFO:   total_rows: 160
[2025-11-04 10:57:21] INFO:   total_columns: 80
[2025-11-04 10:57:21] INFO:   unique_processids: 160
[2025-11-04 10:57:21] INFO:   sequences_present: 160
[2025-11-04 10:57:21] INFO:   sequences_missing: 0
[2025-11-04 10:57:21] INFO:   empty_sequences: 0
[2025-11-04 10:57:21] INFO:   coords_present: 6
[2025-11-04 10:57:21] INFO:   coords_missing: 154
[2025-11-04 10:57:21] INFO:   centroid_coords: 0
[2025-11-04 10:57:21] INFO: Excluded 0 samples with centroid coordinates
[2025-11-04 10:57:21] INFO: Coordinate filtering: 160/160 samples retained (100.0%), 0 excluded
[2025-11-04 10:57:21] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-04 10:57:53] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-04 10:57:53] INFO: Creating point geometries from coordinates
[2025-11-04 10:57:53] INFO: Creating point geometries for 6/160 samples with coordinates
[2025-11-04 10:57:53] INFO: Performing spatial join for 6/160 samples with valid coordinates
[2025-11-04 10:57:53] INFO: Spatial join results: 6 assigned to basins, 0 outside all basins
[2025-11-04 10:57:53] INFO: Assigned 154 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-04 10:57:53] INFO: Running MAFFT alignment: mafft --auto tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:57:59] INFO: MAFFT alignment completed: tests/Euprymna_output/dereplication/Euprymna_aligned.fasta
[2025-11-04 10:57:59] INFO: Running trimAl: trimal -in tests/Euprymna_output/dereplication/Euprymna_aligned.fasta -out tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta -automated1
[2025-11-04 10:58:00] INFO: trimAl completed: tests/Euprymna_output/dereplication/Euprymna_trimmed.fasta
[2025-11-04 10:58:00] INFO: Calculating pairwise distances for 159 sequences
[2025-11-04 10:58:01] INFO: Distance calculation complete: 12561 pairwise distances
[2025-11-04 10:58:01] INFO: Clustering sequences with average linkage, threshold=0.01
[2025-11-04 10:58:01] INFO: Clustering complete: 31 clusters formed
[2025-11-04 10:58:02] INFO: ======================================================================
[2025-11-04 10:58:02] INFO: Starting genotype assignment workflow
[2025-11-04 10:58:02] INFO: ======================================================================
[2025-11-04 10:58:02] INFO: Using edlib for fast edit distance calculation
[2025-11-04 10:58:02] INFO: Step 1/6: Loading metadata from tests/Euprymna_output/02_filtered_metadata.tsv
[2025-11-04 10:58:02] INFO: Loaded 160 samples from metadata
[2025-11-04 10:58:02] INFO: Step 2/6: Loading consensus sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:58:02] INFO: Read 31 sequences from tests/Euprymna_output/Euprymna_consensus.fasta
[2025-11-04 10:58:02] INFO: Loaded 31 consensus groups
[2025-11-04 10:58:02] INFO: Step 3/6: Loading raw sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:58:02] INFO: Read 159 sequences from tests/Euprymna_output/Euprymna.fasta
[2025-11-04 10:58:02] INFO: Extracted 159 unique processids from FASTA
[2025-11-04 10:58:02] INFO: Step 4/6: Preparing assignment tasks
[2025-11-04 10:58:02] INFO: Prepared 160 assignment tasks
[2025-11-04 10:58:02] INFO: Step 5/6: Assigning genotypes (using 2 processes)
[2025-11-04 10:58:05] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:58:05] INFO: Logging to file: tests/test_run.log
[2025-11-04 10:58:05] INFO: Completed genotype assignment for 160 samples
[2025-11-04 10:58:05] INFO: Step 6/6: Writing outputs
[2025-11-04 10:58:05] INFO: Wrote updated metadata to tests/Euprymna_output/Euprymna_with_genotypes.tsv
[2025-11-04 10:58:05] INFO: Wrote diagnostics to tests/Euprymna_output/Euprymna_diagnostics.csv
[2025-11-04 10:58:05] INFO: ======================================================================
[2025-11-04 10:58:05] INFO: Genotype assignment summary:
[2025-11-04 10:58:05] INFO:   Total samples: 160
[2025-11-04 10:58:05] INFO:   Successfully assigned: 92 (57.5%)
[2025-11-04 10:58:05] INFO:   Unassigned: 68 (42.5%)
[2025-11-04 10:58:05] INFO:     - No sequence in FASTA: 1
[2025-11-04 10:58:05] INFO:     - Below identity threshold: 67
[2025-11-04 10:58:05] INFO:   Diagnostic flags:
[2025-11-04 10:58:05] INFO:     - Ties (ambiguous): 39
[2025-11-04 10:58:05] INFO:     - Low confidence: 0
[2025-11-04 10:58:05] INFO: ======================================================================
