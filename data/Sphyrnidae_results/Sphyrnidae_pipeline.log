[2025-11-19 19:14:30] INFO: Logging to file: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_pipeline.log
[2025-11-19 19:14:30] INFO: ================================================================================
[2025-11-19 19:14:30] INFO: BOLDGenotyper Pipeline - Sphyrnidae
[2025-11-19 19:14:30] INFO: ================================================================================
[2025-11-19 19:14:30] INFO: Input TSV: data/Sphyrnidae.tsv
[2025-11-19 19:14:30] INFO: Output directory: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results
[2025-11-19 19:14:30] INFO: 
[2025-11-19 19:14:30] INFO: Saved pipeline parameters to /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_pipeline_parameters.json
[2025-11-19 19:14:30] INFO: PHASE 1: Data Loading and Quality Control
[2025-11-19 19:14:30] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:14:30] INFO: 1.1: Parsing BOLD TSV metadata...
[2025-11-19 19:14:30] INFO: Reading BOLD TSV file: data/Sphyrnidae.tsv
[2025-11-19 19:14:30] INFO: Read 1138 rows and 89 columns
[2025-11-19 19:14:30] WARNING: Found 30 duplicate processids. Examples: ['GBMTG4448-16', 'GBMTG4448-16', 'GBMTG4448-16', 'GBMTG4448-16', 'GBMTG4448-16']. Keeping only first occurrence of each duplicate.
[2025-11-19 19:14:30] INFO: After removing duplicates: 1108 rows remaining
[2025-11-19 19:14:30] INFO: Data quality summary:
[2025-11-19 19:14:30] INFO:   total_rows: 1108
[2025-11-19 19:14:30] INFO:   total_columns: 89
[2025-11-19 19:14:30] INFO:   unique_processids: 1108
[2025-11-19 19:14:30] INFO:   sequences_present: 1107
[2025-11-19 19:14:30] INFO:   sequences_missing: 1
[2025-11-19 19:14:30] INFO:   empty_sequences: 0
[2025-11-19 19:14:30] INFO:   coords_present: 347
[2025-11-19 19:14:30] INFO:   coords_missing: 761
[2025-11-19 19:14:30] INFO:   centroid_coords: 113
[2025-11-19 19:14:30] INFO:   ✓ Loaded 1108 samples with 89 columns
[2025-11-19 19:14:30] INFO: 1.2: Filtering coordinate quality...
[2025-11-19 19:14:30] INFO: Excluded 113 samples with centroid coordinates
[2025-11-19 19:14:30] INFO: Coordinate filtering: 995/1108 samples retained (89.8%), 113 excluded
[2025-11-19 19:14:30] INFO:   ✓ Retained 995/1108 samples after coordinate filtering
[2025-11-19 19:14:30] INFO: 1.3: Assigning ocean basins...
[2025-11-19 19:14:30] INFO: Loading GOaS shapefile from: /Users/stesmith/Documents/depredation/boldgenotyper/GOaS_v1_20211214/goas_v01.shp
[2025-11-19 19:14:54] INFO: Loaded 10 ocean basins from GOaS shapefile
[2025-11-19 19:14:54] INFO: Creating point geometries from coordinates
[2025-11-19 19:14:54] INFO: Creating point geometries for 234/995 samples with coordinates
[2025-11-19 19:14:54] INFO: Performing spatial join for 234/995 samples with valid coordinates
[2025-11-19 19:14:55] INFO: Spatial join results: 113 assigned to basins, 121 outside all basins
[2025-11-19 19:14:55] WARNING: 51.7% of coordinates fall outside GOaS basins. This may indicate terrestrial coordinates or incomplete basin coverage.
[2025-11-19 19:14:55] INFO: Assigned 882 samples to 'Unknown' basin (no coordinates or outside all basins)
[2025-11-19 19:14:55] INFO:   ✓ Assigned ocean basins to samples
[2025-11-19 19:14:55] INFO: 
[2025-11-19 19:14:55] INFO: PHASE 2: Sequence Dereplication and Consensus Generation
[2025-11-19 19:14:55] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:14:55] INFO: 2.1: Generating FASTA from sequences...
[2025-11-19 19:14:55] INFO:   Minimum sequence length: 400 bp
[2025-11-19 19:14:55] WARNING:   ⚠ Skipped 26 samples with missing or invalid sequences
[2025-11-19 19:14:55] INFO:   ✓ Created 969 FASTA records
[2025-11-19 19:14:55] INFO: 2.2: Dereplicating sequences (clustering at 99% identity)...
[2025-11-19 19:14:55] INFO: Running MAFFT alignment: mafft --auto /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/Sphyrnidae.fasta
[2025-11-19 19:15:06] INFO: MAFFT alignment completed: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_aligned.fasta
[2025-11-19 19:15:06] INFO: Running trimAl: trimal -in /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_aligned.fasta -out /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_trimmed.fasta -automated1
[2025-11-19 19:15:09] INFO: trimAl completed: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_trimmed.fasta
[2025-11-19 19:15:09] INFO:   Filtered 3 sequences shorter than 300 bp after trimming
[2025-11-19 19:15:09] INFO: Calculating pairwise distances for 966 sequences
[2025-11-19 19:16:19] INFO: Distance calculation complete: 466095 pairwise distances
[2025-11-19 19:16:19] INFO: Clustering sequences with average linkage, threshold=0.03
[2025-11-19 19:16:19] INFO: Clustering complete: 12 clusters formed
[2025-11-19 19:16:21] INFO: Wrote consensus metadata to /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_consensus_metadata.csv
[2025-11-19 19:16:21] INFO:   ✓ Identified 12 unique genotypes
[2025-11-19 19:16:21] INFO: 
[2025-11-19 19:16:21] INFO: PHASE 3: Genotype Assignment
[2025-11-19 19:16:21] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:16:21] INFO: 3.1: Assigning samples to genotypes...
[2025-11-19 19:16:21] INFO: ======================================================================
[2025-11-19 19:16:21] INFO: Starting genotype assignment workflow
[2025-11-19 19:16:21] INFO: ======================================================================
[2025-11-19 19:16:21] INFO: Using edlib for fast edit distance calculation
[2025-11-19 19:16:21] INFO: Step 1/6: Loading metadata from /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/02_filtered_metadata.tsv
[2025-11-19 19:16:21] INFO: Loaded 995 samples from metadata
[2025-11-19 19:16:21] INFO: Step 2/6: Loading consensus sequences from /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_consensus.fasta
[2025-11-19 19:16:21] INFO: Read 12 sequences from /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_consensus.fasta
[2025-11-19 19:16:21] INFO: Loaded 12 consensus groups
[2025-11-19 19:16:21] INFO: Step 3/6: Loading raw sequences from /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/Sphyrnidae.fasta
[2025-11-19 19:16:21] INFO: Read 969 sequences from /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/Sphyrnidae.fasta
[2025-11-19 19:16:21] INFO: Extracted 969 unique processids from FASTA
[2025-11-19 19:16:21] INFO: Step 4/6: Preparing assignment tasks
[2025-11-19 19:16:21] INFO: Prepared 995 assignment tasks
[2025-11-19 19:16:21] INFO: Step 5/6: Assigning genotypes (using 4 processes)
[2025-11-19 19:16:21] INFO: Identity calculation method: target_based
[2025-11-19 19:16:21] INFO: Tie margin: 0.003, tie_min_identity: 0.95
[2025-11-19 19:16:26] INFO: Completed genotype assignment for 995 samples
[2025-11-19 19:16:26] INFO: Step 6/6: Writing outputs
[2025-11-19 19:16:26] INFO: Wrote updated metadata to /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/genotype_assignments/Sphyrnidae_with_genotypes.tsv
[2025-11-19 19:16:26] INFO: Renamed 11 consensus groups with sample counts (_nZ suffix)
[2025-11-19 19:16:26] INFO: Wrote updated metadata to /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/genotype_assignments/Sphyrnidae_with_genotypes.tsv
[2025-11-19 19:16:26] INFO: Wrote diagnostics to /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/genotype_assignments/Sphyrnidae_diagnostics.csv
[2025-11-19 19:16:26] INFO: ======================================================================
[2025-11-19 19:16:26] INFO: Genotype assignment summary:
[2025-11-19 19:16:26] INFO:   Total samples: 995
[2025-11-19 19:16:26] INFO:   Successfully assigned: 966 (97.1%)
[2025-11-19 19:16:26] INFO:   Unassigned: 29 (2.9%)
[2025-11-19 19:16:26] INFO:     - No sequence in FASTA: 26
[2025-11-19 19:16:26] INFO:     - Below identity threshold: 3
[2025-11-19 19:16:26] INFO:   Diagnostic flags:
[2025-11-19 19:16:26] INFO:     - Ties (ambiguous): 0
[2025-11-19 19:16:26] INFO:     - Low confidence: 0
[2025-11-19 19:16:26] INFO: ======================================================================
[2025-11-19 19:16:26] INFO:   ✓ Assigned 966/995 samples to genotypes
[2025-11-19 19:16:26] INFO:   ✓ Assignment rate: 97.1%
[2025-11-19 19:16:26] INFO: 
[2025-11-19 19:16:26] INFO: PHASE 4: Taxonomy Assignment to Consensus Groups
[2025-11-19 19:16:26] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:16:26] INFO: 4.1: Assigning taxonomy to consensus groups...
[2025-11-19 19:16:26] INFO:   ✓ Assigned taxonomy to 11 consensus groups
[2025-11-19 19:16:26] INFO:   ✓ Saved annotated dataset: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_annotated.csv
[2025-11-19 19:16:26] INFO: 
[2025-11-19 19:16:26] INFO: PHASE 5: Phylogenetic Analysis
[2025-11-19 19:16:26] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:16:26] INFO: 5.1: Building phylogenetic tree...
[2025-11-19 19:16:26] INFO: Running MAFFT alignment: mafft --auto --thread 4 /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_consensus.fasta
[2025-11-19 19:16:27] INFO: MAFFT alignment completed: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/phylogenetic/Sphyrnidae_aligned.fasta
[2025-11-19 19:16:27] INFO: Running FastTree: fasttree -nt -gtr -gamma /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/phylogenetic/Sphyrnidae_aligned.fasta
[2025-11-19 19:16:28] INFO: FastTree completed: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/phylogenetic/Sphyrnidae_tree.nwk
[2025-11-19 19:16:28] INFO:   ✓ Built phylogenetic tree: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/phylogenetic/Sphyrnidae_tree.nwk
[2025-11-19 19:16:28] INFO: 5.2: Creating relabeled tree and alignment files...
[2025-11-19 19:16:28] INFO: Relabeling tree and alignment with consensus_group_sp labels
[2025-11-19 19:16:28] INFO: Loaded 11 label mappings from taxonomy CSV
[2025-11-19 19:16:28] INFO: Created 11 base name mappings
[2025-11-19 19:16:28] WARNING: No mapping found for tree tip: consensus_c8
[2025-11-19 19:16:28] INFO: Relabeled 11 tree tips, wrote to: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/phylogenetic/Sphyrnidae_tree_relabeled.nwk
[2025-11-19 19:16:28] WARNING: No mapping found for sequence: consensus_c8
[2025-11-19 19:16:28] INFO: Relabeled 11 sequences, wrote to: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/phylogenetic/Sphyrnidae_aligned_relabeled.fasta
[2025-11-19 19:16:28] INFO:   ✓ Created relabeled tree: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/phylogenetic/Sphyrnidae_tree_relabeled.nwk
[2025-11-19 19:16:28] INFO:   ✓ Created relabeled alignment (intermediate): /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/phylogenetic/Sphyrnidae_aligned_relabeled.fasta
[2025-11-19 19:16:28] INFO: 
[2025-11-19 19:16:28] INFO: PHASE 6: Visualization
[2025-11-19 19:16:28] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:16:28] INFO: 6.1: Generating plots...
[2025-11-19 19:16:30] INFO: Saved ocean basin abundance (relative) plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_distribution_bar.png
[2025-11-19 19:16:30] INFO: Saved ocean basin abundance (total counts) plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_totaldistribution_bar.png
[2025-11-19 19:16:31] INFO: Saved identity distribution plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_identity_distribution.png
[2025-11-19 19:16:31] INFO: Using relabeled tree for visualization: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/phylogenetic/Sphyrnidae_tree_relabeled.nwk
[2025-11-19 19:16:31] INFO: Auto-scaled tree figure size to (8, 5) for 12 tips
[2025-11-19 19:16:31] INFO: Creating faceted distribution map with cartopy backgrounds, faceting by species
[2025-11-19 19:16:37] INFO: Saved faceted distribution map: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_distribution_map_faceted.png
[2025-11-19 19:16:38] INFO: Saved faceted basin abundance plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_distribution_bar_faceted.png
[2025-11-19 19:16:38] INFO: Saved ocean basin abundance (relative) plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_distribution_bar.pdf
[2025-11-19 19:16:38] INFO: Saved ocean basin abundance (total counts) plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_totaldistribution_bar.pdf
[2025-11-19 19:16:38] INFO: Saved identity distribution plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_identity_distribution.pdf
[2025-11-19 19:16:38] INFO: Using relabeled tree for visualization: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/phylogenetic/Sphyrnidae_tree_relabeled.nwk
[2025-11-19 19:16:38] INFO: Auto-scaled tree figure size to (8, 5) for 12 tips
[2025-11-19 19:16:39] INFO: Creating faceted distribution map with cartopy backgrounds, faceting by species
[2025-11-19 19:16:39] WARNING: Faceted distribution map generation failed: At least one value in the dash list must be positive
Traceback (most recent call last):
  File "/Users/stesmith/Documents/depredation/boldgenotyper/boldgenotyper/cli.py", line 543, in run_pipeline
    visualization.plot_distribution_map_faceted(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        df=df_final,
        ^^^^^^^^^^^^
    ...<8 lines>...
        show_scale_bar=cfg.visualization.show_scale_bar
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/stesmith/Documents/depredation/boldgenotyper/boldgenotyper/visualization.py", line 868, in plot_distribution_map_faceted
    plt.savefig(out, bbox_inches="tight")
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/pyplot.py", line 1251, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 2186, in print_figure
    result = print_method(
        filename,
    ...<3 lines>...
        bbox_inches_restore=_bbox_inches_restore,
        **kwargs)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 2042, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ~~~~^
        *args, **{k: v for k, v in kwargs.items() if k not in skip}))
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backends/backend_pdf.py", line 2786, in print_pdf
    self.figure.draw(renderer)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/artist.py", line 94, in draw_wrapper
    result = draw(artist, renderer, *args, **kwargs)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
    return draw(artist, renderer)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/figure.py", line 3257, in draw
    mimage._draw_list_compositing_images(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        renderer, self, artists, self.suppressComposite)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
    a.draw(renderer)
    ~~~~~~^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
    return draw(artist, renderer)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/cartopy/mpl/geoaxes.py", line 509, in draw
    return super().draw(renderer=renderer, **kwargs)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
    return draw(artist, renderer)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/axes/_base.py", line 3226, in draw
    mimage._draw_list_compositing_images(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        renderer, self, artists, self.get_figure(root=True).suppressComposite)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/image.py", line 134, in _draw_list_compositing_images
    a.draw(renderer)
    ~~~~~~^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/artist.py", line 38, in draw_wrapper
    return draw(artist, renderer, *args, **kwargs)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/cartopy/mpl/gridliner.py", line 1258, in draw
    c.draw(renderer=renderer)
    ~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/artist.py", line 71, in draw_wrapper
    return draw(artist, renderer)
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/collections.py", line 430, in draw
    renderer.draw_path_collection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        gc, transform.frozen(), paths,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        self._antialiaseds, self._urls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        "screen")  # offset_position, kept for backcompat.
        ^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backends/backend_pdf.py", line 2071, in draw_path_collection
    return RendererBase.draw_path_collection(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, gc, master_transform, paths, all_transforms,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        offsets, offset_trans, facecolors, edgecolors,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        linewidths, linestyles, antialiaseds, urls,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        offset_position)
        ^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 236, in draw_path_collection
    for xo, yo, path_id, gc0, rgbFace in self._iter_collection(
                                         ~~~~~~~~~~~~~~~~~~~~~^
            gc, list(path_ids), offsets, offset_trans,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            facecolors, edgecolors, linewidths, linestyles,
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            antialiaseds, urls, offset_position):
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 401, in _iter_collection
    gc0.set_dashes(*ls)
    ~~~~~~~~~~~~~~^^^^^
  File "/Users/stesmith/opt/anaconda3/envs/boldgenotyper/lib/python3.13/site-packages/matplotlib/backend_bases.py", line 879, in set_dashes
    raise ValueError(
        'At least one value in the dash list must be positive')
ValueError: At least one value in the dash list must be positive
[2025-11-19 19:16:40] INFO: Saved faceted basin abundance plot: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/visualization/Sphyrnidae_distribution_bar_faceted.pdf
[2025-11-19 19:16:40] INFO:   ✓ Generated visualization plots
[2025-11-19 19:16:40] INFO: 
[2025-11-19 19:16:40] INFO: PHASE 7: Generating Reports
[2025-11-19 19:16:40] INFO: --------------------------------------------------------------------------------
[2025-11-19 19:16:40] INFO: Assignment summary saved: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/reports/Sphyrnidae_assignment_summary.csv
[2025-11-19 19:16:40] INFO:   ✓ Generated assignment summary: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/reports/Sphyrnidae_assignment_summary.csv
[2025-11-19 19:16:40] INFO: 
[2025-11-19 19:16:40] INFO: Cleaning up empty directories...
[2025-11-19 19:16:40] INFO:   ✓ Removed empty directories
[2025-11-19 19:16:40] INFO: 
[2025-11-19 19:16:40] INFO: Generating HTML summary report...
[2025-11-19 19:16:40] INFO: Generating HTML summary report for Sphyrnidae...
[2025-11-19 19:16:40] INFO: HTML report saved: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_summary_report.html
[2025-11-19 19:16:40] INFO:   ✓ Generated HTML report: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_summary_report.html
[2025-11-19 19:16:40] INFO: 
[2025-11-19 19:16:40] INFO: ================================================================================
[2025-11-19 19:16:40] INFO: ✓ Pipeline completed successfully for Sphyrnidae
[2025-11-19 19:16:40] INFO:   Output directory: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results
[2025-11-19 19:16:40] INFO:   Key files:
[2025-11-19 19:16:40] INFO:     - Annotated data: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_annotated.csv
[2025-11-19 19:16:40] INFO:     - Consensus sequences: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/intermediate/dereplication/Sphyrnidae_consensus.fasta
[2025-11-19 19:16:40] INFO:     - Phylogenetic tree: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/phylogenetic/Sphyrnidae_tree.nwk
[2025-11-19 19:16:40] INFO:     - HTML summary report: /Users/stesmith/Documents/depredation/boldgenotyper/data/Sphyrnidae_results/Sphyrnidae_summary_report.html
[2025-11-19 19:16:40] INFO: ================================================================================
